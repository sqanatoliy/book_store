# Books ETL Pipeline (books_etl.py)

Цей проект реалізує простий ETL-пайплайн на Python для обробки даних про книги з бази даних PostgreSQL, згідно з вимогами технічного завдання.

Пайплайн виконує наступні кроки:
1.  **Extract:** Витягує записи з таблиці `books` за датою останнього оновлення (`last_updated >= cutoff_date`).
2.  **Transform:** Обробляє ціни, створює категорію цін (`budget`/`premium`) та округлює ціну.
3.  **Load:** Завантажує трансформовані дані у таблицю `books_processed`.

---

## Передумови та Залежності

Для запуску проекту необхідно створити та активувати віртуальне оточення тв встановити наступні Python-бібліотеки:

```bash
pip install -r requirements.txt
```
## Налаштування Бази Даних (PostgreSQL)

### 1. Створення схеми та завантаження тестових даних

Перед запуском ETL-скрипта, необхідно створити необхідні таблиці, індекси та тестові записи. Виконайте `books_schema.sql` **один раз**, використовуючи клієнт командного рядка `psql`:

1.  **Створіть файл `.env`** з коректними параметрами підключення (див. нижче).
2.  **Виконайте SQL-файл:**

    ```bash
    # Обов'язково замініть параметри <DB_...> на свої значення
    psql -h <DB_HOST> -p <DB_PORT> -U <DB_USER> -d <DB_NAME> -f books_schema.sql
    ```
    *Цей крок створить таблиці `books` та `books_processed` і додасть 6 тестових записів у `books`.*

### 2. Конфігурація підключення (`.env` файл)

Створіть файл з назвою `.env` у корені проекту та вкажіть у ньому параметри підключення до вашої бази даних.

Примітка: Скрипт `books_etl.py` використовує бібліотеку `python-decouple` для безпечного читання цих параметрів.

```
# Параметри підключення до PostgreSQL
DB_HOST=localhost
DB_PORT=5432
DB_NAME=books_db
DB_USER=etl_user
DB_PASSWORD=your_secure_password
```
## Запуск ETL-Скрипту
Скрипт приймає один обов'язковий аргумент командного рядка: дату відсікання (`cutoff_date`) у форматі `YYYY-MM-DD`. Будуть оброблені лише ті записи, дата оновлення яких (`last_updated`) дорівнює або пізніша за вказану дату.

Формат команди:

```bash
python books_etl.py YYYY-MM-DD
```

Приклад запуску:

```bash
python books_etl.py 2025-01-01
```

Очікуваний вивід у разі успіху:

```text
Підключення до бази даних успішне
Витягнуто 4 записів з таблиці books
Трансформовано 4 записів
Збережено 4 записів в books_processed
ETL процес завершено успішно
```

Очікуваний вивід, якщо нові дані відсутні:

```text
Підключення до бази даних успішне
Витягнуто 0 записів з таблиці books
Нових книг для обробки за вказану дату не знайдено. Роботу завершено
```

---

